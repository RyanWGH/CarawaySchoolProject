<!doctype html>
<html lang="en" class="no-js">
<head>
	<title>Weekly Schedule - Caraway Facilitation</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,600" rel="stylesheet">
	<link rel="stylesheet" href="/css/reset.css"> <!-- CSS reset -->
	<link rel="stylesheet" href="/css/style.css"> <!-- Resource style -->
	  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
	  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

</head>
<body>
	<nav class="navbar navbar-default">
	  <div class="container-fluid">
	    <div class="navbar-header">
	      <a class="navbar-brand" href="/main">Caraway</a>
	    </div>
	    <ul class="nav navbar-nav navbar-left">
	      <li><a href="/main">Home</a></li>
	      <li><a href="/monthSchedule">Schedule</a></li>
	      <li><a href="/donate">Donate Hours</a></li>
	      <li><a href="/requests">Request Absence</a></li>
	      <li><a href="/CreateFacilitator">Create Facilitator</a></li>
	      <li><a href="/contact">Contact</a></li>
	    </ul>
		<u1 class="nav navbar-nav navbar-right">
			<li class="active"><a href="/AccountSettings">Account Settings</a></li>
			<li><a href="/logout">Logout</a></li>
		</u1>
	  </div>
	</nav>

<div align="center"><font size=14 id="schedule-date"></font></div>

<div class="cd-schedule loading">
	<div class="timeline">
		<ul>
			<li><span>08:30</span></li>
			<li><span>09:00</span></li>
			<li><span>09:30</span></li>
			<li><span>10:00</span></li>
			<li><span>10:30</span></li>
			<li><span>11:00</span></li>
			<li><span>11:30</span></li>
			<li><span>12:00</span></li>
			<li><span>12:30</span></li>
			<li><span>13:00</span></li>
			<li><span>13:30</span></li>
			<li><span>14:00</span></li>
			<li><span>14:30</span></li>
			<li><span>15:00</span></li>
			<li><span>15:30</span></li>
			<li><span>16:00</span></li>
			<li><span>16:30</span></li>
			<li><span>17:00</span></li>
			<li><span>17:30</span></li>
			<li><span>18:00</span></li>
		</ul>
	</div> <!-- .timeline -->

	<div class="events">
		<ul>
			<li class="events-group">
				<div class="top-info"><span>Blue Room</span></div>

				<ul>
					<li class="single-event" data-start="08:45" data-end="12:00" data-content="signup" data-event="event-1">
						<a href="#0" class="morning"></a>
					</li>

					<li class="single-event" data-start="12:00" data-end="13:00" data-content="signup" data-event="event-1">
						<a href="#0" class="noon"></a>
					</li>

					<li class="single-event" data-start="13:00" data-end="15:45"  data-content="signup" data-event="event-1">
						<a href="#0" class="afternoon"></a>
					</li>
				</ul>
			</li>

			<li class="events-group">
				<div class="top-info"><span>Purple Room</span></div>

				<ul>
					<li class="single-event" data-start="8:45" data-end="12:00"  data-content="signup" data-event="event-2">
						<a href="#0" class="morning"></a>
					</li>

					<li class="single-event" data-start="12:00" data-end="13:00"  data-content="signup" data-event="event-2">
						<a href="#0" class="noon"></a>
					</li>

					<li class="single-event" data-start="13:00" data-end="15:45" data-content="signup" data-event="event-2">
						<a href="#0" class="afternoon"></a>
					</li>
				</ul>
			</li>

			<li class="events-group">
				<div class="top-info"><span>Green Room</span></div>

				<ul>
					<li class="single-event" data-start="08:45" data-end="12:00" data-content="signup" data-event="event-3">
						<a href="#0" class="morning"></a>
					</li>

					<li class="single-event" data-start="12:00" data-end="13:00" data-content="signup" data-event="event-3">
						<a href="#0" class="noon"></a>
					</li>

					<li class="single-event" data-start="13:00" data-end="15:45"  data-content="signup" data-event="event-3">
						<a href="#0" class="afternoon"></a>
					</li>
				</ul>
			</li>

			<li class="events-group">
				<div class="top-info"><span>Red Room</span></div>

				<ul>
					<li class="single-event" data-start="08:45" data-end="12:00" data-content="signup" data-event="event-4">
						<a href="#0" class="morning"></a>
					</li>

					<li class="single-event" data-start="12:00" data-end="13:00" data-content="signup" data-event="event-4">
						<a href="#0" class="noon"></a>
					</li>

					<li class="single-event" data-start="13:00" data-end="15:45" data-content="signup" data-event="event-4">
						<a href="#0" class="afternoon"></a>
					</li>
				</ul>
			</li>

			<li class="events-group">
				<div class="top-info"><span>Grey Room</span></div>

				<ul>
					<li class="single-event" data-start="8:45" data-end="12:00"  data-content="signup" data-event="event-5">
						<a href="#0" class="morning"></a>
					</li>

					<li class="single-event" data-start="12:00" data-end="13:00" data-content="signup" data-event="event-5">
						<a href="#0" class="noon"></a>
					</li>

					<li class="single-event" data-start="13:00" data-end="15:45"  data-content="signup" data-event="event-5">
						<a href="#0" class="afternoon"></a>
					</li>
				</ul>
			</li>
		</ul>
	</div>

	<div class="event-modal">
		<header class="header">
			<div class="content">
				<span class="event-date"></span>
				<h3 class="event-name"></h3>
			</div>

			<div class="header-bg"></div>
		</header>

		<div class="body">
			<div class="event-info"></div>
			<div class="body-bg"></div>
		</div>

		<a href="#0" class="close">Close</a>
	</div>

	<div class="cover-layer"></div>
</div> <!-- .cd-schedule -->
<script src="/js/modernizr.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.0.0/jquery.min.js"></script>
<script>
	if( !window.jQuery ) document.write('<script src="/js/jquery-3.0.0.min.js"><\/script>');
</script>
<script src="/user/DaySchedule/main.js"></script> <!-- Resource jQuery -->
<script>
	function applyDate(date) {
		$("#schedule-date").text(date.toDateString());
	}

	function loadFacilitations(date, cb = () => {}) {
		$.post('/getfacilitations', {
			day: date.getUTCDate(),
			month: date.getUTCMonth()+1,
			year: date.getUTCFullYear()
		}, (data) => {
			let facilitations = JSON.parse(data);
			applyFacilitations(facilitations);
		});
	}

	function prependZero(time) {
		if (time.length == 4) {
			return '0' + time;
		}
		return time;
	}

	function applyFacilitations(arr) {
		for (let i of arr) {
			let slot = $(`li[data-event='event-${i.roomid}']`);
			let startTime = prependZero(i.timestart);
			if (startTime < "12:00") {
				slot = $(slot.find("a.morning")[0]);
			} else if (startTime < "13:00") {
				slot = $(slot.find("a.noon")[0]);
			} else {
				slot = $(slot.find("a.afternoon")[0]);
			}
			slot.append(`<em class="event-name">${i.firstname} ${i.lastname} (${i.timestart}-${i.timeend})</em><p>`);
		}
	}

	$(document).ready(function() {
		let date = new Date(localStorage.getItem("scheduleDate"));

		applyDate(date);
		loadFacilitations(date);
	});
</script>
</body>
</html>
